(this["webpackJsonpd3js-tutorial"]=this["webpackJsonpd3js-tutorial"]||[]).push([[0],{198:function(t,e,n){},201:function(t,e,n){"use strict";n.r(e);var a=n(3),c=n.n(a),r=n(74),i=n.n(r),s=n(11),o=n(5),l=n(28),d=(n(198),n(2)),u=n(0),h=function(t){var e=t.xScale,n=t.xLength,a=t.filterCondition,c=t.bandwidthOffset,r=void 0===c?0:c,i=t.yOffset,s=void 0===i?0:i,o=t.axisLine,l=void 0!==o&&o,d=t.tickFormat,h=e.domain().filter(a).map((function(t){return Object(u.jsxs)("g",{className:"axis",transform:"translate(".concat(e(t),",0)"),children:[l&&Object(u.jsx)("line",{y2:s}),Object(u.jsx)("line",{className:"tick",y1:s,y2:s+6}),Object(u.jsx)("text",{style:{textAnchor:"middle"},dy:".71em",y:s+14,children:d(t)})]},t)}));return Object(u.jsxs)(u.Fragment,{children:[h,Object(u.jsx)("line",{className:"axis-border",y1:s,y2:s,x1:-r,x2:n+r})]})},j=function(t){var e=t.yScale,n=t.yLength,a=t.xOffset,c=void 0===a?0:a,r=t.numTicks,i=void 0===r?null:r,s=t.tickFormat,o=e.ticks(i).map((function(t){return Object(u.jsxs)("g",{className:"axis",transform:"translate(0,".concat(e(t),")"),children:[Object(u.jsx)("line",{className:"tick",x1:c-6,x2:c}),Object(u.jsx)("text",{style:{textAnchor:"end"},x:c-12,dy:".32em",children:s(t)})]},t)}));return Object(u.jsxs)(u.Fragment,{children:[o,Object(u.jsx)("line",{className:"axis-border",x1:c,x2:c,y2:n})]})},x=function(t){var e=t.yScale,n=t.yLength,a=t.xOffset,c=void 0===a?0:a,r=t.numTicks,i=void 0===r?null:r,s=t.tickFormat,o=e.ticks(i).map((function(t){return Object(u.jsxs)("g",{className:"axis",transform:"translate(0,".concat(e(t),")"),children:[Object(u.jsx)("line",{className:"tick",x1:c+6,x2:c}),Object(u.jsx)("text",{style:{textAnchor:"start"},x:c+12,dy:".32em",children:s(t)})]},t)}));return Object(u.jsxs)(u.Fragment,{children:[o,Object(u.jsx)("line",{className:"axis-border",x1:c,x2:c,y2:n})]})},f=Object(d.m)("%B %-d, %Y"),b=Object(d.e)(".2f"),m=Object(d.e)(".3s"),g=function(t){var e=t.data,n=t.xScale,a=t.yScale;return e.map((function(t){return Object(u.jsxs)("g",{className:"candlestick-mark",transform:"translate(".concat(n(t.date),",0)"),children:[Object(u.jsx)("line",{y1:a(t.low),y2:a(t.high)}),Object(u.jsx)("line",{y1:a(t.open),y2:a(t.close),strokeWidth:n.bandwidth(),stroke:t.open>t.close?d.j[0]:t.close>t.open?d.j[2]:d.j[8],"data-tip":"<b>".concat(f(t.date),"</b><br />")+"Open: $".concat(b(t.open),"<br />")+"Close: $".concat(b(t.close),"<br />")+"Low: $".concat(b(t.low),"<br />")+"High: $".concat(b(t.high),"<br />")+"Volume: ".concat(m(t.volume)),"data-for":"mark-tooltip"})]},t.date)}))},O=function(t){var e=t.data,n=t.xScale,a=t.innerHeight;return e.map((function(t){return t.eventTitle&&Object(u.jsx)("g",{transform:"translate(".concat(n(t.date),",").concat(a,") scale(0.025,-0.025)"),fill:"#000000",stroke:"none","data-tip":t.eventTitle,"data-for":"mark-tooltip",onClick:t.eventCallback,children:Object(u.jsx)("path",{d:"M500 1394 c-132 -35 -260 -153 -334 -306 -65 -136 -80 -207 -80 -368 0 -161 15 -232 80 -368 95 -197 266 -322 444 -322 220 0 427 193 502 468 30 110 30 334 0 445 -46 166 -161 330 -284 404 -99 60 -217 77 -328 47z m260 -490 c0 -27 -4 -43 -10 -39 -5 3 -10 11 -10 17 0 6 -7 20 -17 30 -13 14 -31 18 -95 18 l-78 0 0 -90 0 -91 67 3 c64 3 69 5 83 33 l15 30 3 -37 c2 -21 2 -55 0 -75 l-3 -38 -15 30 c-14 28 -19 30 -83 33 l-68 3 3 -93 3 -93 55 -3 c90 -5 117 4 147 49 14 22 28 37 30 35 3 -3 -3 -27 -12 -55 l-17 -51 -171 1 c-125 1 -163 3 -139 10 l32 10 0 194 0 194 -32 10 c-24 7 14 9 140 10 l172 1 0 -46z"})})}))},y=function(t){var e=t.data,n=t.xScale,a=t.yScale,c=t.innerHeight;return e.map((function(t){return Object(u.jsx)("rect",{className:"volume-mark",x:n(t.date)-n.bandwidth()/2,y:a(t.volume),width:n.bandwidth(),height:c-a(t.volume)},t.date)}))},p=d.e("$~f"),v=d.e("~s"),k=d.m("%-m/%-d"),S=function(t){var e=t.data,n=t.specs,a=n.width,c=n.height,r=n.margin,i=a-r.left-r.right,s=c-r.top-r.bottom,o=d.h().domain(d.l.range(e[0].date,+e[e.length-1].date+1).filter((function(t){return 0!==t.getUTCDay()&&6!==t.getUTCDay()}))).range([0,i]).padding(.2),l=d.i().domain([d.g(e,(function(t){return t.low})),d.f(e,(function(t){return t.high}))]).rangeRound([s,0]).nice(),f=d.i().domain([0,d.f(e,(function(t){return t.volume}))]).rangeRound([s,0]).nice();return Object(u.jsxs)("g",{transform:"translate(".concat(r.left,",").concat(r.top,")"),children:[Object(u.jsx)(h,{xScale:o,xLength:i,filterCondition:function(t){return 1===t.getUTCDay()},yOffset:s,bandwidthOffset:o.bandwidth()/2,axisLine:!0,tickFormat:k}),Object(u.jsx)(j,{yScale:l,yLength:s,xOffset:-o.bandwidth()/2,tickFormat:p}),Object(u.jsx)("text",{className:"axis-label",textAnchor:"middle",transform:"translate(".concat(-60,",").concat(s/2,") rotate(-90)"),children:"Price"}),Object(u.jsx)(x,{yScale:f,yLength:s,xOffset:i+o.bandwidth()/2,tickFormat:v}),Object(u.jsx)("text",{className:"axis-label",textAnchor:"middle",transform:"translate(".concat(i+60,",").concat(s/2,") rotate(90)"),children:"Volume"}),Object(u.jsx)(y,{data:e,xScale:o,yScale:f,innerHeight:s}),Object(u.jsx)(g,{data:e,xScale:o,yScale:l}),Object(u.jsx)(O,{data:e,xScale:o,innerHeight:s})]})},w=function(t){var e=t.data,n=t.xScale,a=t.yScale;return Object(u.jsx)("path",{className:"line-mark",d:Object(d.a)().x((function(t){return n(t.date)})).y0(a(0)).y1((function(t){return a(t.close)})).curve(d.d)(e)})},C=d.e("$~f"),T=d.m("%Y"),F=function(t){var e=t.data,n=t.specs,c=n.width,r=n.height,i=n.margin,s=n.yAxisNumTicks,o=t.initialBrushExtent,l=t.setBrushExtent,x=Object(a.useRef)(),f=c-i.left-i.right,b=r-i.top-i.bottom,m=Object(a.useMemo)((function(){return d.h().domain(d.l.range(e[0].date,+e[e.length-1].date+1).filter((function(t){return 0!==t.getUTCDay()&&6!==t.getUTCDay()}))).range([0,f]).padding(.2)}),[e,f]),g=Object(a.useMemo)((function(){return d.i().domain([0,d.f(e,(function(t){return t.high}))]).range([b,0]).nice()}),[e,b]);Object(a.useEffect)((function(){var t=d.b().extent([[0,0],[f,b]]).on("brush",(function(t){l(t.selection&&t.selection.map(function(t){var e=t.domain(),n=t(e[0]),a=t.step();return function(t){var c=Math.floor((t-n)/a);return e[Math.max(0,Math.min(c,e.length-1))]}}(m)))})),e=d.k(x.current);t(e),t.move(e,[m(o[0]),m(o[1])])}),[m,f,b]);return Object(u.jsxs)("g",{transform:"translate(".concat(i.left,",").concat(i.top,")"),children:[Object(u.jsx)(w,{data:e,xScale:m,yScale:g}),Object(u.jsx)(h,{xScale:m,xLength:f,yOffset:b,filterCondition:function(t){return 1===t.getUTCDay()&&t.getUTCDate()<=7&&0===t.getUTCMonth()},tickFormat:T}),Object(u.jsx)(j,{yScale:g,yLength:b,numTicks:s,tickFormat:C}),Object(u.jsx)("text",{className:"axis-label",textAnchor:"middle",transform:"translate(".concat(-60,",").concat(b/2,") rotate(-90)"),children:"Price"}),Object(u.jsx)("g",{ref:x})]})},N=function(t){var e=t.specs,n=e.totalWidth,c=e.totalHeight,r=e.seperationRatio,i=e.brushSpecs,h=e.mainChartSpecs,j=function(){var t=Object(a.useState)(null),e=Object(o.a)(t,2),n=e[0],c=e[1];return Object(a.useEffect)((function(){Object(d.c)("https://gist.githubusercontent.com/alvin-yang68/825378ee22558f0ced78a2ca74c931a7/raw/AAPLStockHistory.csv",(function(t){return t.date=new Date(t.date),t.volume=+t.volume,t.open=+t.open,t.close=+t.close,t.high=+t.high,t.low=+t.low,t.eventTitle=Math.random()<.05?"This is an event":null,t.eventCallback=function(){return console.log("Hello world")},t})).then(c)}),[]),n}(),x=Object(a.useState)(),f=Object(o.a)(x,2),b=f[0],m=f[1];if(Object(a.useEffect)((function(){l.a.rebuild()})),!j)return Object(u.jsx)("pre",{children:"Loading..."});h=Object(s.a)(Object(s.a)({},h),{},{width:n,height:c*r}),i=Object(s.a)(Object(s.a)({},i),{},{width:n,height:c*(1-r)});var g=[j[j.length-i.brushSize].date,j[j.length-1].date],O=b?j.filter((function(t){return t.date>b[0]&&t.date<b[1]})):j.filter((function(t){return t.date>g[0]&&t.date<g[1]}));return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsxs)("svg",{width:n,height:c,children:[Object(u.jsx)(S,{data:O,specs:h}),Object(u.jsx)("g",{transform:"translate(0,".concat(c*r,")"),children:Object(u.jsx)(F,{data:j,specs:i,initialBrushExtent:g,setBrushExtent:m})})]}),Object(u.jsx)(l.a,{id:"mark-tooltip",place:"right",effect:"solid",html:!0})]})};var L=function(){return Object(u.jsx)(u.Fragment,{children:Object(u.jsx)(N,{specs:{totalWidth:1200,totalHeight:750,seperationRatio:.8,mainChartSpecs:{margin:{top:20,right:80,bottom:40,left:80}},brushSpecs:{brushSize:130,margin:{top:20,right:80,bottom:40,left:80},yAxisNumTicks:5}}})})},A=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,203)).then((function(e){var n=e.getCLS,a=e.getFID,c=e.getFCP,r=e.getLCP,i=e.getTTFB;n(t),a(t),c(t),r(t),i(t)}))};i.a.render(Object(u.jsx)(c.a.StrictMode,{children:Object(u.jsx)(L,{})}),document.getElementById("root")),A()}},[[201,1,2]]]);
//# sourceMappingURL=main.c3960c0d.chunk.js.map